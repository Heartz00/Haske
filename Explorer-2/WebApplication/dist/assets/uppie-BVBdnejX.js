const w={name:"files[]"};function b(i,n,a){typeof n=="function"?(a=n,n=w):(n||(n={}),n.name||(n.name=w.name));for(const r of i instanceof NodeList||Array.isArray(i)?i:[i])E(r,n,a)}function E(i,n,a){var r;if(((r=i.tagName)==null?void 0:r.toLowerCase())==="input"&&i.type==="file")i.addEventListener("change",t=>{var e,f;(f=(e=t.target)==null?void 0:e.files)!=null&&f.length?h(t.target,n,a.bind(null,t)):a(t)});else{const t=e=>e.preventDefault();i.addEventListener("dragover",t),i.addEventListener("dragenter",t),i.addEventListener("drop",e=>{var f,s;e.preventDefault(),(s=(f=e.dataTransfer.items)==null?void 0:f[0])!=null&&s.webkitGetAsEntry()?P(e.dataTransfer.items,n,a.bind(null,e)):e.dataTransfer.files?h(e.dataTransfer,n,a.bind(null,e)):a(e)})}}function h(i,n,a){const r=new FormData,t=[];for(const e of i.files)r.append(n.name,e,e.webkitRelativePath||e.name),t.push(e.webkitRelativePath||e.name);a(r,t)}function y(i,n,a,r){const t=n||i.createReader();t.readEntries(e=>{const f=a?a.concat(e):e;e.length?setTimeout(y.bind(null,i,t,f,r),0):r(f)})}function P(i,n,a){const r=new FormData,t=[],e=[];function f(s,l,o){l||(l=s.name),y(s,0,0,g=>{const u=[];for(const d of g)u.push(new Promise(m=>{d.isFile?d.file(c=>{const p=`${l}/${c.name}`;r.append(n.name,c,p),t.push(p),m()},m.bind()):f(d,`${l}/${d.name}`,m)}));Promise.all(u).then(o.bind())})}for(let s of i)s=s.webkitGetAsEntry(),s&&e.push(new Promise(l=>{s.isFile?s.file(o=>{r.append(n.name,o,o.name),t.push(o.name),l()},l.bind()):s.isDirectory&&f(s,null,l)}));Promise.all(e).then(a.bind(null,r,t))}export{b as u};
